{% extends "base/base.html" %}

{% block content %}

    <h1 class="page-header">{{ unit }}</h1>

    <div class="row">
        <div class="col-sm-9">
            <table class="table table-striped table-hover">
                <tbody>
                    <tr>
                        <td>Name</td>
                        <td>
                            {% if unit.owner_character == request.hero %}
                                <form class="form-inline" role="form" method="post" action="{% url 'world:rename_unit' unit.id %}">
                                    {% csrf_token %}
                                    <input
                                            class="form-control form-control"
                                            type="text"
                                            value="{{ unit.name }}"
                                            maxlength="100"
                                            name="name"
                                    >
                                    <button type="submit" class="btn btn-primary btn-sm">Rename</button>
                                </form>
                            {% else %}
                                {{ unit.name }}
                            {% endif %}
                        </td>
                    </tr>
                    <tr>
                        <td>Owner</td>
                        <td>{{ unit.owner_character }}</td>
                    </tr>
                    <tr>
                        <td>Soldiers</td>
                        <td>{{ unit.soldier.all|length }}</td>
                    </tr>
                    <tr>
                        <td>Type</td>
                        <td>{{ unit.get_type_display|capfirst }}</td>
                    </tr>
                    <tr>
                        <td>Status</td>
                        <td>
                            {% if unit.owner_character == request.hero %}
                            <form class="form-inline" role="form" method="post" action="{% url 'world:unit_status_change' unit.id 'not mobilized' %}">
                                    {% csrf_token %}
                                    <button
                                        type="submit"
                                        class="btn btn-sm
                                        {% if unit.status == 'not mobilized' %}disabled btn-success
                                        {% else %}btn-primary
                                        {% endif %}">
                                        Not mobilized
                                    </button>
                                </form>
                            </p>
                            <p>
                                <form class="form-inline" role="form" method="post" action="{% url 'world:unit_status_change' unit.id 'standing' %}">
                                    {% csrf_token %}
                                    <button
                                        type="submit"
                                        class="btn btn-sm
                                        {% if unit.status == 'standing' %}disabled btn-success
                                        {% else %}btn-primary
                                        {% endif %}">
                                        Standing
                                    </button>
                                </form>
                            </p>
                            <p>
                                <form class="form-inline" role="form" method="post" action="{% url 'world:unit_status_change' unit.id 'following' %}">
                                    {% csrf_token %}
                                    <button
                                        type="submit"
                                        class="btn btn-sm
                                        {% if unit.status == 'following' %}disabled btn-success
                                        {% else %}btn-primary
                                        {% endif %}">
                                        Following
                                    </button>
                                </form>
                            {% else %}
                                {{ unit.get_status_display|capfirst }}
                            {% endif %}
                        </td>
                    </tr>
                    <tr>
                        <td>Location</td>
                        <td>{{ unit.location }} ({{ unit.location.tile }}, {{ unit.location.tile.controlled_by }})</td>
                    </tr>
                    <tr>
                        <td>Recruitment type</td>
                        <td>{{ unit.get_recruitment_type_display|capfirst }}</td>
                    </tr>
                    <tr>
                        <td>Average skill</td>
                        <td>{{ unit.average_fighting_skill }}%</td>
                    </tr>
                    <tr>
                        <td>Training</td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="col-sm-3">
            {% if unit.owner_character == request.hero %}
                <h4>Actions</h4>
                <p>
                    <a class="btn btn-sm btn-primary" href="{% url 'world:unit_merge' unit.id %}">Merge</a>
                </p>
                <p>
                    <a class="btn btn-sm btn-primary" href="{% url 'world:unit_transfer' unit.id %}">Transfer</a>
                </p>
                <p>
                    <form class="form-inline" role="form" method="post" action="{% url 'world:unit_disband' unit.id %}">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure?')">
                            Disband
                        </button>
                    </form>
                </p>
            {% endif %}
        </div>
    </div>

    <div class="col-sm-6 col-md-3 well">
        <canvas id="gender_chart"></canvas>
        <script>
            var ctx = $('#gender_chart');
            var data = {
                labels: ["Female", "Male",],
                datasets: [
                    {
                        data: [222, 33],
                        backgroundColor: ["#6AFF68", "#FAFF74", ],
                        hoverBackgroundColor: ["#6AFF68",  "#FAFF74", ]
                    }]
            };
            var my_gender_chart = new Chart(ctx,{type: 'pie', data: data, options: {}});
        </script>
    </div>

    <div class="col-sm-6 col-md-3 well">
        <canvas id="training_chart"></canvas>
        <script>
            var ctx = $('#training_chart');
            var data = {
                labels: ["High skill", "Average skill", "Low skill"],
                datasets: [
                    {
                        data: [222, 33, 12],
                        backgroundColor: ["#FF5654", "#6AFF68", "#FAFF74"],
                        hoverBackgroundColor: ["#FF5654", "#6AFF68", "#FAFF74"],
                    }]
            };
            var my_gender_chart = new Chart(ctx,{type: 'pie', data: data, options: {}});
        </script>
    </div>

    <div class="col-md-3 well">
        <canvas id="age_chart"></canvas>
        <script>
            var ctx = $('#age_chart');
            var data = {
                labels: ["Very young", "Young", "Middle", "Old"],
                datasets: [
                    {
                        data: [222, 33, 12, 31],
                        backgroundColor: ["#6AFF68", "#FF5654", "#6AFF68", "#FAFF74"],
                        hoverBackgroundColor: ["#6AFF68", "#FF5654", "#6AFF68", "#FAFF74"],
                    }]
            };
            var my_gender_chart = new Chart(ctx,{type: 'pie', data: data, options: {}});
        </script>
    </div>

    <div class="col-md-3 well">
        <canvas id="professionality_chart"></canvas>
        <script>
            var ctx = $('#professionality_chart');
            var data = {
                labels: ["Professional", "Non-professional"],
                datasets: [
                    {
                        data: [222, 33],
                        backgroundColor: ["#6AFF68", "#FF5654"],
                        hoverBackgroundColor: ["#6AFF68", "#FF5654"],
                    }]
            };
            var my_gender_chart = new Chart(ctx,{type: 'pie', data: data, options: {}});
        </script>
    </div>

    <div class="col-md-3 well">
        <canvas id="origin_chart"></canvas>
        <script>
            var ctx = $('#origin_chart');
            var data = {
                labels: ["Valley", "Iadar"],
                datasets: [
                    {
                        data: [222, 33],
                        backgroundColor: ["#6AFF68", "#FF5654"],
                        hoverBackgroundColor: ["#6AFF68", "#FF5654"],
                    }]
            };
            var my_gender_chart = new Chart(ctx,{type: 'pie', data: data, options: {}});
        </script>
    </div>

{% endblock %}
